name: .NET

on:
  push:
    branches: [ main ]

jobs:
  build:

    runs-on: ubuntu-latest

    steps:
    - uses: actions/checkout@v2
    - name: Setup .NET
      uses: actions/setup-dotnet@v1
      with:
        dotnet-version: 5.0.x
    - name: Restore dependencies
      run: dotnet restore
    - name: Build
      run: dotnet build --no-restore
      env:
            Configuration: Release
    - name: Archive Action
      # You may pin to the exact commit or the version.
      # uses: ihiroky/archive-action@e8b4644f992de8f7423e0bd7292c2e047ecf26ce
      uses: ihiroky/archive-action@v1
      with:
        # Root directory.
        root_dir: $GITHUB_WORKSPACE/Filewatcher/bin/Release/net5.0
        # Base directory; common prefix of all files and directories in the archive, relative to root_dir.
        # base_dir: # optional, default is .
        # Output file path. Supported extensions: zip, tar, tar.gz(tgz), tar.bz2(tbz2), tar.xz(txz)
        # file_path: # optional, default is output.zip
        # Shows details about the result of running this action.
        # verbose: # optional
    - name: github-action-publish-binaries
      # You may pin to the exact commit or the version.
      # uses: skx/github-action-publish-binaries@b9ca5643b2f1d7371a6cba7f35333f1461bbc703
      uses: skx/github-action-publish-binaries@release-2.0
      with:
        # The pattern of files to upload
        args: 'output.zip'
        # The release Id of the release to be targeted.
      env:
        GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
